<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" type="image/svg+xml" href="/vite.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>apirtc-web</title>
		<script type="text/javascript" src="https://cdn.apirtc.com/apiRTC/apiRTC-latest.min.js"></script>
		<script type="module" src="/src/main.ts"></script>
	</head>
	<body>
	 <div class="container-fluid vh-100 p-0 d-flex">

        <div id="user-list" class="col-3 d-flex flex-column bg-white p-4 shadow-lg" style="min-width: 250px; max-width: 350px;">
            <div class="d-flex align-items-center justify-content-between mb-4">
                <h2 class="h5 font-weight-bold text-dark">Conversations</h2>
                <button class="btn btn-sm text-secondary hover-text-indigo p-0 border-0" aria-label="New Chat">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
                </button>
            </div>
            <ul class="list-group list-group-flush flex-grow-1" id="users"></ul>
        </div>

        <div class="col-9 d-flex flex-column bg-chat-bg p-0">
            <div id="defaultChatMessageBox" class="h-100">
                <div class="d-flex flex-column justify-content-center align-items-center h-100">
                    <h1 class="text-muted">Welcome to our chat</h1>
                    <p class="text-muted">Select a conversation to start chatting.</p>
                </div>
            </div>
            <div id="visible-main-chat-wrapper" class="d-none">
                <div class="d-flex flex-column h-100" >
                    <div class="p-3 bg-white border-bottom shadow-sm sticky-top" style="z-index: 1000;">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center gap-3">
                                <img src="https://placehold.co/40x40/4F46E5/ffffff?text=U1" alt="Recipient" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;">
                                <div>
                                    <h5 class="h6 mb-0 font-weight-semibold text-dark" id="chat-recipient">Alex Johnson</h5>
                                    <span id="status-badge" class="badge badge-success font-weight-normal">Active now</span>
                                </div>
                            </div>

                            <div class="d-flex" style="gap: 8px;">
                                <button id="audioCallBtn" class="btn btn-light rounded-circle p-2 shadow-sm text-indigo border-0" aria-label="Start Audio Call" style="width: 40px; height: 40px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6.71-6.71 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.09 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                                </button>
                                <button id="videoCallBtn" class="btn bg-indigo rounded-circle p-2 shadow-custom text-white border-0" aria-label="Start Video Call" style="width: 40px; height: 40px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 17l4.5 3V4l-4.5 3"/><rect x="3" y="5" width="12" height="14" rx="2" ry="2"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="chat-box" class="flex-grow-1 p-4 vh-100" style="overflow-y: auto;">
                        <div class="d-flex flex-column space-y-4">
                            <div style="height: 50px;"></div>
                        </div>
                    </div>

                    <div class="p-3 bg-white border-top shadow-sm">
                        <form  id="sendBtn">
                            <div class="d-flex align-items-center">
                                <button class="btn btn-light rounded-circle p-2 text-secondary border-0 mr-2" aria-label="Attach File">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19"/></svg>
                                </button>

                                <input id="msgInput" type="text"
                                    class="form-control form-control-lg rounded-pill border-secondary flex-grow-1"
                                    placeholder="Type your message here..."
                                    style="box-shadow: none;">

                                <button  type="submit"
                                    class="btn bg-indigo text-white font-weight-semibold rounded-pill px-4 py-2 ml-2 shadow-custom border-0">
                                    Send
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>  
            
            
            
        </div>
    </div>

    <!-- 
    ==============================
    CALL MODAL STRUCTURES
    ==============================
    -->

    <!-- Outgoing Call Modal -->
    <div class="modal fade" id="outgoingCallModal" tabindex="-1" aria-labelledby="outgoingCallModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-lg border-0 shadow-lg">
                <div class="modal-header border-0 pb-0 d-flex justify-content-end">
                    <!-- Close button, hidden but kept for accessibility -->
                    <button type="button" class="close text-indigo" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center pt-1">
                    <h5 class="modal-title text-indigo font-weight-bold mb-4" id="outgoingCallModalLabel">Starting <span id="callTypeOutgoing"></span> Call...</h5>
                    
                    <img id="callerAvatarOutgoing" src="https://placehold.co/80x80/4F46E5/ffffff?text=U1" alt="Recipient" class="rounded-circle mb-3 border border-indigo border-3" style="width: 80px; height: 80px; object-fit: cover;">
                    <p class="lead font-weight-bold text-dark mb-1" id="recipientNameOutgoing">Alex Johnson</p>
                    <p class="text-muted mb-4" id="callStatusOutgoing">Calling...</p>

                    <!-- Ring animation (Bootstrap Spinner) -->
                    <div class="spinner-border text-indigo mb-4" role="status">
                        <span class="sr-only">Calling...</span>
                    </div>
                </div>
                <div class="modal-footer justify-content-center border-0 pt-0">
                    <button type="button" class="btn btn-danger rounded-circle p-3 shadow-lg" data-dismiss="modal" style="width: 55px; height: 55px;" aria-label="End Call">
                        <!-- Phone Off Icon -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(135deg);"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6.71-6.71 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.09 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Incoming Call Modal -->
    <div class="modal fade" id="incomingCallModal" tabindex="-1" aria-labelledby="incomingCallModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-lg border-0 shadow-lg bg-indigo text-white">
                <div class="modal-body text-center p-5">
                    <p class="small font-weight-light" style="color: #E0E7FF;">Incoming <span id="callTypeIncoming">Video</span> Call</p>
                    
                    <img id="callerAvatarIncoming" src="https://placehold.co/100x100/EF4444/ffffff?text=U2" alt="Caller" class="rounded-circle mb-3 border border-white border-3" style="width: 100px; height: 100px; object-fit: cover;">
                    <p class="h4 font-weight-bold mb-1" id="callerNameIncoming">Jane Smith</p>
                    <p class="text-white mb-5">Ringing...</p>

                    <div id="remote-container"></div>
                    <div id="local-container"></div>
                    <div id="status"></div>

                    <div class="d-flex justify-content-center" style="gap: 1.5rem;">
                        <button type="button"  id="callDeclineButton" class="btn btn-danger rounded-circle p-3 shadow-lg" data-dismiss="modal" style="width: 60px; height: 60px;" aria-label="Decline">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(135deg);"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6.71-6.71 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.09 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        </button>
                        <button type="button" class="btn btn-success rounded-circle p-3 shadow-lg" id="callAcceptButton" style="width: 60px; height: 60px;" aria-label="Answer">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.05 5a5 5 0 0 1 5 5"/><path d="M15.05 1a9 9 0 0 1 9 9"/><path d="M4 16h8"/><path d="M11 20L4 13 4 5C4 3.34315 5.34315 2 7 2h10c1.65685 0 3 1.34315 3 3v8l-7 7"/></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


      <!-- User identity form  -->
    <div class="modal fade" id="useridentity" tabindex="-1" aria-labelledby="incomingCallModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-lg border-0 shadow-lg bg-indigo text-white">
                <div class="modal-body text-center p-5">
                   <p>It looks like this is your first time here. Please provide your details to continue.</p>
                    <form id="user-form">
                        <input type="text" class="form-control" id="username-input" required placeholder="Enter your name">
                        <br>
                        <input type="email" class="form-control" id="email-input" required placeholder="Enter your email">
                    </form> 
                </div>
                <div class="modal-footer">
                    <button id="save-cookie-btn" class="btn btn-primary">Save
                        <div  class="spinner-border text-light d-none" style="width: 1rem; height: 1rem;" role="status">
                            <span class="sr-only">Loading...</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

		<template id="message-template">
			<!-- justify-content-start -->
			<div class="d-flex justify-content-start mb-3">
					<div style="max-width: 60%;">
						<p class="mb-0 ml-1 small text-muted font-weight-bold message-sender">Alex Johnson</p>
						<div class="bg-white p-3 rounded-lg rounded-t-0 shadow-sm">
							<p class="mb-1 small message-content">Hey, I finished the initial wireframes for the new dashboard. Take a look when you have a moment!</p>
							<span class="text-xs text-muted d-block text-right message-timestamp" style="font-size: 0.65rem;">10:05 AM</span>
						</div>
					</div>
				</div>
		</template>

		<template id="user-template">
			<li class="list-group-item bg-indigo-lightest p-3 rounded-lg mb-2 cursor-pointer border-0" style="background-color: rgba(79, 70, 229, 0.1);">
				<div class="d-flex align-items-center">
					<div class="position-relative mr-3">
						<img src="https://placehold.co/40x40/4F46E5/ffffff?text=U1" alt="User 1" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;">
						<span class="position-absolute badge-dot badge-success rounded-circle border border-white" style="bottom: 0; right: 0; width: 10px; height: 10px;"></span>
					</div>
					<div class="flex-grow-1 overflow-hidden">
						<p class="mb-0 small font-weight-bold text-indigo text-truncate username">Alex Johnson</p>
						<p class="mb-0 small text-muted text-truncate userid">Hey, check out this doc...</p>
					</div>
				</div>
			</li>
		</template>
	</body>
</html>


